{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<h1>Admin Dashboard</h1>

<!-- Admin Info Section -->
<div style="background-color: #f9f9f9; padding: 15px; margin-bottom: 20px; border: 1px solid #ddd;">
  <h2>Welcome, {{ request.user.username }}</h2>
  <p><strong>Email:</strong> {{ request.user.email }}</p>
  <p><strong>Role:</strong> Administrator</p>
  <form action="{% url 'logout' %}" method="post">
    {% csrf_token %}
    <button type="submit">Logout</button>
  </form>
</div>

<!-- Match Requests Section -->
<h2>Match Requests</h2>

{% for request in match_requests %}
  <div style="border:1px solid #ccc; padding:15px; margin:15px 0; border-radius: 5px;">
    <p><strong>Project Title:</strong> {{ request.project.title }}</p>
    <p><strong>Publication Title:</strong> {{ request.publication.title }}</p>
    <p><strong>Matched Title:</strong> {{ request.match_title }}</p>
    <p><strong>Similarity Score:</strong> {{ request.match_score|floatformat:2 }}</p>
    <p><strong>Shared Authors:</strong> {{ request.match_authors }}</p>
    <p><strong>Approval Status:</strong> 
      {% if request.approved == True %}
        ✅ Approved
      {% elif request.approved == False %}
        ❌ Rejected
      {% else %}
        ⏳ Pending
      {% endif %}
    </p>

    {% if request.approved == None %}
      <form method="post" action="{% url 'accept_match_request' request.id %}">
        {% csrf_token %}
        <button name="decision" value="yes">Accept</button>
        <button name="decision" value="no">Reject</button>
      </form>
    {% endif %}
  </div>
{% empty %}
  <p>No pending match requests.</p>
{% endfor %}
{% endblock %}
