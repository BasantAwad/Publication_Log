{% extends "base.html" %}
{% block title %}Administrator Dashboard{% endblock %}

{% block content %}

<!-- Admin Info Section -->
<div style="padding: 15px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 8px;">
  <h2>Welcome, {{ request.user.username }} <span class="glyphicon glyphicon-user" aria-hidden="true"></span></h2>
  <p><strong>Email:</strong> {{ request.user.email }} <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span></p>
  <p><strong>Role:</strong> Administrator <span class="glyphicon glyphicon-cog" aria-hidden="true"></span></p>
  <form action="{% url 'logout' %}" method="post">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger btn-sm">
      <span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> Logout
    </button>
  </form>
</div>

<!-- Match Requests Section -->
<h2>Match Requests <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span></h2>

{% for request in match_requests %}
  <div style="border:1px solid #ccc; padding:15px; margin:15px 0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); background: #fff;">
    <p><strong>Project Title:</strong> {{ request.project.title }} <span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span></p>
    <p><strong>Publication Title:</strong> {{ request.publication.title }} <span class="glyphicon glyphicon-book" aria-hidden="true"></span></p>
    <p><strong>Matched Title:</strong> {{ request.match_title }} <span class="glyphicon glyphicon-tags" aria-hidden="true"></span></p>
    <p><strong>Similarity Score:</strong> {{ request.match_score|floatformat:2 }} <span class="glyphicon glyphicon-stats" aria-hidden="true"></span></p>
    <p><strong>Shared Authors:</strong> {{ request.match_authors }} <span class="glyphicon glyphicon-user" aria-hidden="true"></span></p>
    <p><strong>Approval Status:</strong> 
      {% if request.approved == True %}
        ✅ Approved <span class="glyphicon glyphicon-ok-circle" aria-hidden="true" style="color:green;"></span>
      {% elif request.approved == False %}
        ❌ Rejected <span class="glyphicon glyphicon-remove-circle" aria-hidden="true" style="color:red;"></span>
      {% else %}
        ⏳ Pending <span class="glyphicon glyphicon-time" aria-hidden="true" style="color:orange;"></span>
      {% endif %}
    </p>

    {% if request.approved == None %}
      <form method="post" action="{% url 'accept_match_request' request.id %}">
        {% csrf_token %}
        <button name="decision" value="yes" class="btn btn-success btn-sm">
          <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Accept
        </button>
        <button name="decision" value="no" class="btn btn-danger btn-sm">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Reject
        </button>
      </form>
    {% endif %}
  </div>
{% empty %}
  <p>No pending match requests.</p>
{% endfor %}
{% endblock %}
