{% extends "base.html" %}
{% block title %}Projects{% endblock %}

{% block content %}
<div class="container">
  <!-- ✅ Sidebar Filters -->
  <aside class="sidebar">
    <form method="get" id="searchForm">
      <input type="text" name="search" id="searchInput" class="search-input"
             placeholder="Search projects..." value="{{ search_query }}"
             oninput="document.getElementById('searchForm').submit();">

      <h3>Filter</h3>

      <label for="domain">Domain:</label>
      <select name="domain" id="domain" onchange="this.form.submit()">
        <option value="">All</option>
        {% for domain in domains %}
          <option value="{{ domain }}" {% if selected_domain == domain %}selected{% endif %}>{{ domain }}</option>
        {% endfor %}
      </select>

      <label for="year">Year:</label>
      <select name="year" id="year" onchange="this.form.submit()">
        <option value="">All</option>
        {% for year in years %}
          <option value="{{ year }}" {% if selected_year|stringformat:"s" == year|stringformat:"s" %}selected{% endif %}>
            {{ year }}
          </option>
        {% endfor %}
      </select>

      <hr>

      <h3>Sort</h3>
      <select name="sort" onchange="this.form.submit()">
        <option value="newest" {% if selected_sort == "newest" %}selected{% endif %}>Newest</option>
        <option value="oldest" {% if selected_sort == "oldest" %}selected{% endif %}>Oldest</option>
      </select>
    </form>
  </aside>

  <!-- ✅ Project List -->
  <main class="project-list">
    {% if projects %}
      {% for project in projects %}
        <div class="project-box">
          <h3>
            <a href="{% url 'project_detail' pk=project.pk %}" class="font-bold text-purple-800 hover:underline">
              {{ project.title }}
            </a>
          </h3>
          <p><strong>Domain:</strong> {{ project.domain }}</p>
          <p><strong>Year:</strong> {{ project.created.year }}</p>
        </div>
      {% endfor %}
    {% else %}
      <p>No matching projects found.</p>
    {% endif %}
  </main>
</div>
{% endblock %}
